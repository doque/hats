@(hatElapsedTime:List[(String, Long)], cardDetails: List[(String, List[(String, Long)])], cards: List[Card], buckets: List[Bucket])
@import models._

@main("Dashboard", null) {
<div class="row">
	<h1>Dashboard <small>Statistics Overview</small></h1>
</div><!-- /.row -->
<div class="row">
	<div class="well col-lg-12" id="progressbar">
		@progressbar.render
	</div>
</div><!-- /.row -->
<!-- Reused the CSS from style.css -->
<div id="hat" class="blue">
	<div style="display:none" class = "card blue"></div>
	<div style="display:none" class = "card black"></div>
	<div style="display:none" class = "card red"></div>
	<div style="display:none" class = "card green"></div>
	<div style="display:none" class = "card white"></div>
	<div style="display:none" class = "card yellow"></div>
	<!-- Buckets for Cards-->
	<div class="row">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Bucket Thing(Not Ready Yet)</h3>
			</div>
			<div class="panel-body">
				<div id="mytest"> </div>
			</div>
		</div>	
	</div><!-- /.row -->
	<div class="row">
		<!-- Stacked bar chart for Cards of each User-->
		<div class="col-lg-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Card Status for Each User</h3>
				</div>
				<div class="panel-body">
					<div id="cards-user-current-session" style="width:100%;height:300px;"></div>
				</div>
			</div>
		</div>
		<!-- Donut Chart: Elapsed time per hats  -->
		<div class="col-lg-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Elapsed Time Per Hat(Current Session)</h3>
				</div>
				<div class="panel-body">
					<div id="elapsed-time-chart-donut" style="width:100%;height:300px;" ></div>
				</div>
			</div>
		</div>
	</div><!-- /.row -->
	<div>
		<script>
			var hatArray = [];
			var hatColor = [];
			// Gets time for each hats
			//sets label and  value for Donut Chart
			@for(hTime <- hatElapsedTime){
				var obj = {
					value: @hTime._2,
					label: '@hTime._1',
				}
				hatArray.push(obj);
				// Sets color for each hat
				var setColor = $("#hat.blue div.card.@hTime._1.toLowerCase").css("background-color");
				hatColor.push(setColor);
			}
			// Plot the Donut Chart
			Morris.Donut({
				element: 'elapsed-time-chart-donut',
				data: hatArray,
				colors: hatColor
			});	
		</script>
		<script>
		//  Plot the stacked bar chart
			$(function () {
				var cardArrForHats = []; // card numbers for user in each hat
				var cardsForUser =[]; //card numbers for each user
				var labelArray = []; // user name labels
				var labelArr = [];
				var m = 0;
				@for( (key, values) <- cardDetails) { //For Each Hat user and total cards details
					var k = 0;
					@values.map { value =>
						cardArrForHats.push([k, @value._2]); //Arrays for saving total cards for each user
						labelArray.push([k,"@value._1.toLowerCase"]); //Arrays for saving usernames
						k += 1;
					}
					if(m == 0){
						labelArr =labelArray.slice(0);
					}
					// sets color for each hats
					var setColor = $("#hat.blue div.card.@key.toLowerCase").css("background-color");
					m += 1;
					//  Now sets all the user along with cards for each hats into cardsForUser Array
					var obj = {
						data: cardArrForHats,
						label: '@key',
						color: setColor
					}
					cardsForUser.push(obj);
					cardArrForHats =[];
				}
				function plotWithOptions() {
					$.plot($("#cards-user-current-session"), cardsForUser, {
						series: {
							stack: 1,
							lines: { show: false, fill: true, steps: false },
							bars: { show: true, barWidth: 0.15, align: "center" }
						},
						grid: { hoverable: true, show: true }
					});
				}
				plotWithOptions();
				$("#cards-user-current-session").UseTooltip();
			});
		</script>

}